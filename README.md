<div align="center">
  ![image](https://github.com/user-attachments/assets/47ce3f9f-c011-4e5f-af0d-ee51f2ef2f5f)

  >Link: https://vsm-lecture-storage-system.onrender.com/auth/login
  
  # 🏃‍♂️ VSM Lecture System
  
  **Vietnam Student Marathon - Hệ thống quản lý bài giảng hiện đại**
  
  [![Next.js](https://img.shields.io/badge/Next.js-15.0-black?style=for-the-badge&logo=next.js)](https://nextjs.org/)
  [![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?style=for-the-badge&logo=typescript)](https://www.typescriptlang.org/)
  [![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.4-38bdf8?style=for-the-badge&logo=tailwind-css)](https://tailwindcss.com/)
  [![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)](LICENSE)
  
  [🚀 Demo Live](#) • [📖 Tài liệu](#) • [🐛 Báo lỗi](#) • [💡 Đề xuất tính năng](#)
  
</div>

---

## 📋 Mục lục

- [🎯 Giới thiệu](#-giới-thiệu)
- [✨ Tính năng chính](#-tính-năng-chính)
- [🖼️ Screenshots](#️-screenshots)
- [🛠️ Công nghệ sử dụng](#️-công-nghệ-sử-dụng)
- [⚡ Cài đặt nhanh](#-cài-đặt-nhanh)
- [🚀 Hướng dẫn sử dụng](#-hướng-dẫn-sử-dụng)
- [🏗️ Kiến trúc Backend](#️-kiến-trúc-backend)
- [📡 API Documentation](#-api-documentation)
- [🔧 Development](#-development)
- [🤝 Đóng góp](#-đóng-góp)
- [📄 License](#-license)

---

## 🎯 Giới thiệu

**VSM Lecture System** là một hệ thống quản lý bài giảng hiện đại được thiết kế dành riêng cho cộng đồng **Vietnam Student Marathon**. Hệ thống cung cấp một nền tảng toàn diện để chia sẻ, quản lý và trình chiếu các bài giảng về marathon, chạy bộ và thể thao.

### 🎯 Mục tiêu

- 📚 **Chia sẻ kiến thức**: Tạo kho tài liệu phong phú về marathon và chạy bộ
- 🤝 **Kết nối cộng đồng**: Xây dựng mạng lưới runner Việt Nam
- 🎓 **Giáo dục chất lượng**: Cung cấp nội dung học tập chuyên nghiệp
- 💻 **Trải nghiệm hiện đại**: Interface thân thiện và tính năng tiên tiến

---

## ✨ Tính năng chính

### 👥 **Quản lý người dùng**
- 🔐 **Xác thực đa cấp**: Admin, Giảng viên, Người xem
- 👤 **Hồ sơ cá nhân**: Quản lý thông tin và yêu cầu chỉnh sửa
- 🛡️ **Bảo mật**: Phân quyền chi tiết và bảo vệ dữ liệu

### 📚 **Quản lý bài giảng**
- 📄 **PDF Viewer tiên tiến**: Zoom, xoay, tìm kiếm, ghi chú
- 🎥 **Presentation Mode**: Trình chiếu fullscreen với laser pointer
- ❤️ **Tương tác**: Like, bookmark, download
- 🔍 **Tìm kiếm thông minh**: Filter theo tháng, năm, tác giả
- 📊 **Thống kê**: Lượt xem, độ phổ biến

### 📅 **Quản lý lịch**
- 🗓️ **Calendar tương tác**: View tháng với sự kiện
- 🎉 **Ngày lễ Việt Nam**: Tích hợp sẵn các ngày lễ
- ⏰ **Nhắc nhở**: Notification cho sự kiện
- 🎨 **Màu sắc**: Phân loại sự kiện bằng màu

### 📤 **Upload & Quản lý**
- 📁 **Drag & Drop**: Upload file PDF dễ dàng
- 📋 **Metadata**: Thông tin chi tiết bài giảng
- 🔄 **Progress tracking**: Theo dõi tiến trình upload
- ✅ **Validation**: Kiểm tra file và dữ liệu

### 🎨 **Giao diện & UX**
- 🌙 **Dark/Light Mode**: Chế độ sáng/tối
- 📱 **Responsive**: Tối ưu cho mọi thiết bị
- ⚡ **Performance**: Tải nhanh và mượt mà
- 🎭 **Animations**: Hiệu ứng chuyển động đẹp mắt

---

## 🖼️ Screenshots

<div align="center">
### 🏠 Login
![image](https://github.com/user-attachments/assets/9e01b012-1812-4a60-a327-9d65b079ef16)
 
### 🏠 Dashboard
![image](https://github.com/user-attachments/assets/fbb9543f-7b02-491d-b570-a406f5f0c5d4)

### 📚 Lecture Management
![image](https://github.com/user-attachments/assets/dfdc700b-99a1-4039-bdfb-6c0cfdc4b285)

### 🎥 Presentation Mode
![Presentation](https://via.placeholder.com/800x400/7c3aed/ffffff?text=Presentation+Mode)

### 📅 Calendar System
![image](https://github.com/user-attachments/assets/ffc968ad-e3bb-4d29-87c3-1af0ed32cb89)

### QUẢN TRỊ
![image](https://github.com/user-attachments/assets/28fe1969-2a09-4409-9536-b77a32cc3200)


</div>

---

## 🛠️ Công nghệ sử dụng

### **Frontend**
- ⚛️ **Next.js 15** - React framework với App Router
- 🎨 **Tailwind CSS** - Utility-first CSS framework
- 🧩 **shadcn/ui** - Component library hiện đại
- 📝 **TypeScript** - Type safety và developer experience
- 🎭 **Framer Motion** - Animations và transitions
- 🎯 **Lucide React** - Icon library đẹp và nhất quán

### **Backend (Khuyến nghị)**
- 🟢 **Node.js** với **Express.js** hoặc **Fastify**
- 🗄️ **PostgreSQL** với **Prisma ORM**
- 🔐 **JWT** cho authentication
- ☁️ **AWS S3** hoặc **Cloudinary** cho file storage
- 📧 **Nodemailer** cho email notifications
- 🔍 **Elasticsearch** cho full-text search

### **DevOps & Deployment**
- 🐳 **Docker** - Containerization
- ☁️ **Vercel** - Frontend deployment
- 🚀 **Railway/Heroku** - Backend deployment
- 📊 **Vercel Analytics** - Performance monitoring

---

## ⚡ Cài đặt nhanh

### **Prerequisites**
- Node.js 18+ 
- npm/yarn/pnpm
- Git

### **1. Clone Repository**
```bash
git clone https://github.com/StephenSouth13/VSM_Lecture_Storage_System.git
cd vsm-lecture-system

```markdown
<div align="center">
  <img src="https://via.placeholder.com/120x120/22c55e/ffffff?text=VSM" alt="VSM Logo" width="120" height="120">
  
  # 🏃‍♂️ VSM Lecture System
  
  **Vietnam Student Marathon - Hệ thống quản lý bài giảng hiện đại**
  
  [![Next.js](https://img.shields.io/badge/Next.js-15.0-black?style=for-the-badge&logo=next.js)](https://nextjs.org/)
  [![TypeScript](https://img.shields.io/badge/TypeScript-5.0-blue?style=for-the-badge&logo=typescript)](https://www.typescriptlang.org/)
  [![Tailwind CSS](https://img.shields.io/badge/Tailwind-3.4-38bdf8?style=for-the-badge&logo=tailwind-css)](https://tailwindcss.com/)
  [![License](https://img.shields.io/badge/License-MIT-green?style=for-the-badge)](LICENSE)
  
  [🚀 Demo Live](#) • [📖 Tài liệu](#) • [🐛 Báo lỗi](#) • [💡 Đề xuất tính năng](#)
  
</div>

---

## 📋 Mục lục

- [🎯 Giới thiệu](#-giới-thiệu)
- [✨ Tính năng chính](#-tính-năng-chính)
- [🖼️ Screenshots](#️-screenshots)
- [🛠️ Công nghệ sử dụng](#️-công-nghệ-sử-dụng)
- [⚡ Cài đặt nhanh](#-cài-đặt-nhanh)
- [🚀 Hướng dẫn sử dụng](#-hướng-dẫn-sử-dụng)
- [🏗️ Kiến trúc Backend](#️-kiến-trúc-backend)
- [📡 API Documentation](#-api-documentation)
- [🔧 Development](#-development)
- [🤝 Đóng góp](#-đóng-góp)
- [📄 License](#-license)

---

## 🎯 Giới thiệu

**VSM Lecture System** là một hệ thống quản lý bài giảng hiện đại được thiết kế dành riêng cho cộng đồng **Vietnam Student Marathon**. Hệ thống cung cấp một nền tảng toàn diện để chia sẻ, quản lý và trình chiếu các bài giảng về marathon, chạy bộ và thể thao.

### 🎯 Mục tiêu

- 📚 **Chia sẻ kiến thức**: Tạo kho tài liệu phong phú về marathon và chạy bộ
- 🤝 **Kết nối cộng đồng**: Xây dựng mạng lưới runner Việt Nam
- 🎓 **Giáo dục chất lượng**: Cung cấp nội dung học tập chuyên nghiệp
- 💻 **Trải nghiệm hiện đại**: Interface thân thiện và tính năng tiên tiến

---

## ✨ Tính năng chính

### 👥 **Quản lý người dùng**
- 🔐 **Xác thực đa cấp**: Admin, Giảng viên, Người xem
- 👤 **Hồ sơ cá nhân**: Quản lý thông tin và yêu cầu chỉnh sửa
- 🛡️ **Bảo mật**: Phân quyền chi tiết và bảo vệ dữ liệu

### 📚 **Quản lý bài giảng**
- 📄 **PDF Viewer tiên tiến**: Zoom, xoay, tìm kiếm, ghi chú
- 🎥 **Presentation Mode**: Trình chiếu fullscreen với laser pointer
- ❤️ **Tương tác**: Like, bookmark, download
- 🔍 **Tìm kiếm thông minh**: Filter theo tháng, năm, tác giả
- 📊 **Thống kê**: Lượt xem, độ phổ biến

### 📅 **Quản lý lịch**
- 🗓️ **Calendar tương tác**: View tháng với sự kiện
- 🎉 **Ngày lễ Việt Nam**: Tích hợp sẵn các ngày lễ
- ⏰ **Nhắc nhở**: Notification cho sự kiện
- 🎨 **Màu sắc**: Phân loại sự kiện bằng màu

### 📤 **Upload & Quản lý**
- 📁 **Drag & Drop**: Upload file PDF dễ dàng
- 📋 **Metadata**: Thông tin chi tiết bài giảng
- 🔄 **Progress tracking**: Theo dõi tiến trình upload
- ✅ **Validation**: Kiểm tra file và dữ liệu

### 🎨 **Giao diện & UX**
- 🌙 **Dark/Light Mode**: Chế độ sáng/tối
- 📱 **Responsive**: Tối ưu cho mọi thiết bị
- ⚡ **Performance**: Tải nhanh và mượt mà
- 🎭 **Animations**: Hiệu ứng chuyển động đẹp mắt

---

## 🖼️ Screenshots

<div align="center">
  
### 🏠 Dashboard
![Dashboard](https://via.placeholder.com/800x400/1f2937/ffffff?text=Dashboard+Overview)

### 📚 Lecture Management
![Lectures](https://via.placeholder.com/800x400/059669/ffffff?text=Lecture+Management)

### 🎥 Presentation Mode
![Presentation](https://via.placeholder.com/800x400/7c3aed/ffffff?text=Presentation+Mode)

### 📅 Calendar System
![Calendar](https://via.placeholder.com/800x400/dc2626/ffffff?text=Calendar+System)

</div>

---

## 🛠️ Công nghệ sử dụng

### **Frontend**
- ⚛️ **Next.js 15** - React framework với App Router
- 🎨 **Tailwind CSS** - Utility-first CSS framework
- 🧩 **shadcn/ui** - Component library hiện đại
- 📝 **TypeScript** - Type safety và developer experience
- 🎭 **Framer Motion** - Animations và transitions
- 🎯 **Lucide React** - Icon library đẹp và nhất quán

### **Backend (Khuyến nghị)**
- 🟢 **Node.js** với **Express.js** hoặc **Fastify**
- 🗄️ **PostgreSQL** với **Prisma ORM**
- 🔐 **JWT** cho authentication
- ☁️ **AWS S3** hoặc **Cloudinary** cho file storage
- 📧 **Nodemailer** cho email notifications
- 🔍 **Elasticsearch** cho full-text search

### **DevOps & Deployment**
- 🐳 **Docker** - Containerization
- ☁️ **Vercel** - Frontend deployment
- 🚀 **Railway/Heroku** - Backend deployment
- 📊 **Vercel Analytics** - Performance monitoring

---

## ⚡ Cài đặt nhanh

### **Prerequisites**
- Node.js 18+ 
- npm/yarn/pnpm
- Git

### **1. Clone Repository**
```bash
git clone https://github.com/your-username/vsm-lecture-system.git
cd vsm-lecture-system
```

### **2. Install Dependencies**

```shellscript
npm install
# hoặc
yarn install
# hoặc
pnpm install
```

### **3. Environment Setup**

```shellscript
cp .env.example .env.local
```

Cập nhật file `.env.local`:

```plaintext
# Database
DATABASE_URL="postgresql://username:password@localhost:5432/vsm_lectures"

# Authentication
NEXTAUTH_SECRET="your-secret-key"
NEXTAUTH_URL="http://localhost:3000"

# File Storage
AWS_ACCESS_KEY_ID="your-aws-key"
AWS_SECRET_ACCESS_KEY="your-aws-secret"
AWS_BUCKET_NAME="vsm-lectures"

# Email
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"
```

### **4. Database Setup**

```shellscript
npx prisma migrate dev
npx prisma db seed
```

### **5. Run Development Server**

```shellscript
npm run dev
```

🎉 **Mở trình duyệt tại** `http://localhost:3000`

---

## Hướng dẫn sử dụng

### **👤 Đăng nhập Demo**

| Vai trò | Email | Password | Quyền hạn
|-----|-----|-----|-----
| 👑 **Admin** | `admin@example.com` | `admin123` | Toàn quyền quản trị
| 👨‍🏫 **Giảng viên** | `teacher@example.com` | `teacher123` | Upload, quản lý bài giảng
| 👁️ **Người xem** | `viewer@example.com` | `viewer123` | Xem và tương tác


### **📚 Quản lý bài giảng**

1. **Upload bài giảng mới**:

1. Vào `Dashboard > Tải lên`
2. Kéo thả file PDF hoặc click chọn
3. Điền thông tin metadata
4. Click "Tải lên bài giảng"



2. **Xem bài giảng**:

1. Vào `Dashboard > Bài giảng`
2. Click vào bài giảng muốn xem
3. Sử dụng các controls: zoom, xoay, ghi chú



3. **Presentation Mode**:

1. Click nút "Trình chiếu"
2. Sử dụng phím tắt:

1. `←→`: Chuyển trang
2. `Space`: Phát/Dừng auto-play
3. `F`: Fullscreen
4. `Esc`: Thoát








### **📅 Quản lý lịch**

1. **Tạo sự kiện**:

1. Vào `Dashboard > Lịch`
2. Click "Tạo sự kiện"
3. Điền thông tin và chọn màu
4. Đặt nhắc nhở (tùy chọn)



2. **Xem sự kiện**:

1. Click vào ngày trên calendar
2. Xem danh sách sự kiện
3. Edit/Delete sự kiện





---

## ️ Kiến trúc Backend

### **📊 Database Schema**

```sql
-- Users table
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  name VARCHAR(255) NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  role user_role NOT NULL DEFAULT 'viewer',
  avatar_url TEXT,
  date_of_birth DATE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- Lectures table
CREATE TABLE lectures (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title VARCHAR(500) NOT NULL,
  description TEXT,
  file_url TEXT NOT NULL,
  preview_url TEXT,
  owner_id UUID REFERENCES users(id),
  allow_download BOOLEAN DEFAULT true,
  month INTEGER NOT NULL,
  year INTEGER NOT NULL,
  views_count INTEGER DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

-- Calendar Events table
CREATE TABLE calendar_events (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  title VARCHAR(255) NOT NULL,
  description TEXT,
  color VARCHAR(7) NOT NULL,
  start_time TIMESTAMP NOT NULL,
  end_time TIMESTAMP NOT NULL,
  remind_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);

-- Favorites table
CREATE TABLE favorites (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  lecture_id UUID REFERENCES lectures(id),
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, lecture_id)
);

-- Edit Requests table
CREATE TABLE edit_requests (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES users(id),
  content TEXT NOT NULL,
  status request_status DEFAULT 'pending',
  admin_response TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### **🔧 Backend Structure**

```plaintext
backend/
├── src/
│   ├── controllers/          # Route handlers
│   │   ├── auth.controller.js
│   │   ├── lectures.controller.js
│   │   ├── calendar.controller.js
│   │   └── users.controller.js
│   ├── middleware/           # Custom middleware
│   │   ├── auth.middleware.js
│   │   ├── upload.middleware.js
│   │   └── validation.middleware.js
│   ├── models/              # Database models
│   │   ├── User.js
│   │   ├── Lecture.js
│   │   └── CalendarEvent.js
│   ├── routes/              # API routes
│   │   ├── auth.routes.js
│   │   ├── lectures.routes.js
│   │   └── calendar.routes.js
│   ├── services/            # Business logic
│   │   ├── auth.service.js
│   │   ├── file.service.js
│   │   └── email.service.js
│   ├── utils/               # Utilities
│   │   ├── database.js
│   │   ├── logger.js
│   │   └── helpers.js
│   └── app.js               # Express app setup
├── prisma/
│   ├── schema.prisma        # Database schema
│   └── seed.js              # Database seeding
├── uploads/                 # Local file storage
├── .env.example
├── package.json
└── README.md
```

### **🚀 Backend Setup Guide**

#### **1. Initialize Backend Project**

```shellscript
mkdir vsm-backend
cd vsm-backend
npm init -y
```

#### **2. Install Dependencies**

```shellscript
# Core dependencies
npm install express cors helmet morgan dotenv
npm install @prisma/client prisma
npm install bcryptjs jsonwebtoken
npm install multer aws-sdk
npm install nodemailer
npm install joi express-rate-limit

# Development dependencies
npm install -D nodemon @types/node typescript
```

#### **3. Setup Prisma**

```shellscript
npx prisma init
```

**prisma/schema.prisma**:

```plaintext
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(cuid())
  email       String   @unique
  name        String
  passwordHash String  @map("password_hash")
  role        Role     @default(VIEWER)
  avatarUrl   String?  @map("avatar_url")
  dateOfBirth DateTime? @map("date_of_birth")
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  lectures       Lecture[]
  calendarEvents CalendarEvent[]
  favorites      Favorite[]
  editRequests   EditRequest[]

  @@map("users")
}

model Lecture {
  id           String   @id @default(cuid())
  title        String
  description  String?
  fileUrl      String   @map("file_url")
  previewUrl   String?  @map("preview_url")
  ownerId      String   @map("owner_id")
  allowDownload Boolean @default(true) @map("allow_download")
  month        Int
  year         Int
  viewsCount   Int      @default(0) @map("views_count")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  owner     User       @relation(fields: [ownerId], references: [id])
  favorites Favorite[]

  @@map("lectures")
}

model CalendarEvent {
  id          String    @id @default(cuid())
  userId      String    @map("user_id")
  title       String
  description String?
  color       String
  startTime   DateTime  @map("start_time")
  endTime     DateTime  @map("end_time")
  remindAt    DateTime? @map("remind_at")
  createdAt   DateTime  @default(now()) @map("created_at")

  user User @relation(fields: [userId], references: [id])

  @@map("calendar_events")
}

model Favorite {
  id        String   @id @default(cuid())
  userId    String   @map("user_id")
  lectureId String   @map("lecture_id")
  createdAt DateTime @default(now()) @map("created_at")

  user    User    @relation(fields: [userId], references: [id])
  lecture Lecture @relation(fields: [lectureId], references: [id])

  @@unique([userId, lectureId])
  @@map("favorites")
}

model EditRequest {
  id            String        @id @default(cuid())
  userId        String        @map("user_id")
  content       String
  status        RequestStatus @default(PENDING)
  adminResponse String?       @map("admin_response")
  createdAt     DateTime      @default(now()) @map("created_at")
  updatedAt     DateTime      @updatedAt @map("updated_at")

  user User @relation(fields: [userId], references: [id])

  @@map("edit_requests")
}

enum Role {
  ADMIN
  TEACHER
  VIEWER
}

enum RequestStatus {
  PENDING
  APPROVED
  REJECTED
}
```

#### **4. Main App Setup**

**src/app.js**:

```javascript
const express = require('express');
const cors = require('cors');
const helmet = require('helmet');
const morgan = require('morgan');
const rateLimit = require('express-rate-limit');
require('dotenv').config();

const authRoutes = require('./routes/auth.routes');
const lectureRoutes = require('./routes/lectures.routes');
const calendarRoutes = require('./routes/calendar.routes');
const userRoutes = require('./routes/users.routes');

const app = express();

// Security middleware
app.use(helmet());
app.use(cors({
  origin: process.env.FRONTEND_URL || 'http://localhost:3000',
  credentials: true
}));

// Rate limiting
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 100 // limit each IP to 100 requests per windowMs
});
app.use(limiter);

// Body parsing middleware
app.use(express.json({ limit: '10mb' }));
app.use(express.urlencoded({ extended: true }));

// Logging
app.use(morgan('combined'));

// Routes
app.use('/api/auth', authRoutes);
app.use('/api/lectures', lectureRoutes);
app.use('/api/calendar', calendarRoutes);
app.use('/api/users', userRoutes);

// Health check
app.get('/health', (req, res) => {
  res.json({ status: 'OK', timestamp: new Date().toISOString() });
});

// Error handling middleware
app.use((err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ 
    error: 'Something went wrong!',
    message: process.env.NODE_ENV === 'development' ? err.message : undefined
  });
});

// 404 handler
app.use('*', (req, res) => {
  res.status(404).json({ error: 'Route not found' });
});

const PORT = process.env.PORT || 5000;
app.listen(PORT, () => {
  console.log(`🚀 Server running on port ${PORT}`);
});

module.exports = app;
```

#### **5. Authentication Controller**

**src/controllers/auth.controller.js**:

```javascript
const bcrypt = require('bcryptjs');
const jwt = require('jsonwebtoken');
const { PrismaClient } = require('@prisma/client');
const Joi = require('joi');

const prisma = new PrismaClient();

// Validation schemas
const registerSchema = Joi.object({
  name: Joi.string().min(2).max(100).required(),
  email: Joi.string().email().required(),
  password: Joi.string().min(6).required(),
  role: Joi.string().valid('ADMIN', 'TEACHER', 'VIEWER').default('VIEWER')
});

const loginSchema = Joi.object({
  email: Joi.string().email().required(),
  password: Joi.string().required()
});

// Register user
exports.register = async (req, res) => {
  try {
    const { error, value } = registerSchema.validate(req.body);
    if (error) {
      return res.status(400).json({ error: error.details[0].message });
    }

    const { name, email, password, role } = value;

    // Check if user exists
    const existingUser = await prisma.user.findUnique({
      where: { email }
    });

    if (existingUser) {
      return res.status(400).json({ error: 'User already exists' });
    }

    // Hash password
    const passwordHash = await bcrypt.hash(password, 12);

    // Create user
    const user = await prisma.user.create({
      data: {
        name,
        email,
        passwordHash,
        role
      },
      select: {
        id: true,
        name: true,
        email: true,
        role: true,
        createdAt: true
      }
    });

    // Generate JWT
    const token = jwt.sign(
      { userId: user.id, email: user.email, role: user.role },
      process.env.JWT_SECRET,
      { expiresIn: '7d' }
    );

    res.status(201).json({
      message: 'User created successfully',
      user,
      token
    });
  } catch (error) {
    console.error('Register error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
};

// Login user
exports.login = async (req, res) => {
  try {
    const { error, value } = loginSchema.validate(req.body);
    if (error) {
      return res.status(400).json({ error: error.details[0].message });
    }

    const { email, password } = value;

    // Find user
    const user = await prisma.user.findUnique({
      where: { email }
    });

    if (!user) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Check password
    const isValidPassword = await bcrypt.compare(password, user.passwordHash);
    if (!isValidPassword) {
      return res.status(401).json({ error: 'Invalid credentials' });
    }

    // Generate JWT
    const token = jwt.sign(
      { userId: user.id, email: user.email, role: user.role },
      process.env.JWT_SECRET,
      { expiresIn: '7d' }
    );

    res.json({
      message: 'Login successful',
      user: {
        id: user.id,
        name: user.name,
        email: user.email,
        role: user.role,
        avatarUrl: user.avatarUrl
      },
      token
    });
  } catch (error) {
    console.error('Login error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
};

// Get current user
exports.getMe = async (req, res) => {
  try {
    const user = await prisma.user.findUnique({
      where: { id: req.user.userId },
      select: {
        id: true,
        name: true,
        email: true,
        role: true,
        avatarUrl: true,
        dateOfBirth: true,
        createdAt: true,
        updatedAt: true
      }
    });

    if (!user) {
      return res.status(404).json({ error: 'User not found' });
    }

    res.json({ user });
  } catch (error) {
    console.error('Get user error:', error);
    res.status(500).json({ error: 'Internal server error' });
  }
};
```

#### **6. File Upload Service**

**src/services/file.service.js**:

```javascript
const AWS = require('aws-sdk');
const multer = require('multer');
const path = require('path');

// Configure AWS
const s3 = new AWS.S3({
  accessKeyId: process.env.AWS_ACCESS_KEY_ID,
  secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY,
  region: process.env.AWS_REGION || 'us-east-1'
});

// Multer configuration
const storage = multer.memoryStorage();

const fileFilter = (req, file, cb) => {
  if (file.mimetype === 'application/pdf') {
    cb(null, true);
  } else {
    cb(new Error('Only PDF files are allowed'), false);
  }
};

const upload = multer({
  storage,
  fileFilter,
  limits: {
    fileSize: 50 * 1024 * 1024 // 50MB limit
  }
});

// Upload to S3
exports.uploadToS3 = async (file, folder = 'lectures') => {
  const fileName = `${folder}/${Date.now()}-${file.originalname}`;
  
  const params = {
    Bucket: process.env.AWS_BUCKET_NAME,
    Key: fileName,
    Body: file.buffer,
    ContentType: file.mimetype,
    ACL: 'public-read'
  };

  try {
    const result = await s3.upload(params).promise();
    return result.Location;
  } catch (error) {
    console.error('S3 upload error:', error);
    throw new Error('File upload failed');
  }
};

// Delete from S3
exports.deleteFromS3 = async (fileUrl) => {
  const key = fileUrl.split('/').slice(-2).join('/');
  
  const params = {
    Bucket: process.env.AWS_BUCKET_NAME,
    Key: key
  };

  try {
    await s3.deleteObject(params).promise();
    return true;
  } catch (error) {
    console.error('S3 delete error:', error);
    throw new Error('File deletion failed');
  }
};

exports.uploadMiddleware = upload;
```

#### **7. Environment Variables**

**.env.example**:

```plaintext
# Database
DATABASE_URL="postgresql://username:password@localhost:5432/vsm_lectures"

# JWT
JWT_SECRET="your-super-secret-jwt-key-here"

# AWS S3
AWS_ACCESS_KEY_ID="your-aws-access-key"
AWS_SECRET_ACCESS_KEY="your-aws-secret-key"
AWS_BUCKET_NAME="vsm-lectures-bucket"
AWS_REGION="us-east-1"

# Email
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_USER="your-email@gmail.com"
SMTP_PASS="your-app-password"

# App
NODE_ENV="development"
PORT=5000
FRONTEND_URL="http://localhost:3000"

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

---

## API Documentation

### **🔐 Authentication Endpoints**

#### **POST**`/api/auth/register`

```json
{
  "name": "Quách Thành Long",
  "email": "user@example.com",
  "password": "password123",
  "role": "VIEWER"
}
```

#### **POST**`/api/auth/login`

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

#### **GET**`/api/auth/me`

Headers: `Authorization: Bearer <token>`

### **📚 Lectures Endpoints**

#### **GET**`/api/lectures`

Query params: `page`, `limit`, `search`, `month`, `year`, `owner`

#### **POST**`/api/lectures`

Headers: `Authorization: Bearer <token>`
Content-Type: `multipart/form-data`

```plaintext
title: "Lecture Title"
description: "Lecture Description"
month: 3
year: 2024
allowDownload: true
file: [PDF file]
```

#### **GET**`/api/lectures/:id`

#### **PUT**`/api/lectures/:id`

#### **DELETE**`/api/lectures/:id`

### **📅 Calendar Endpoints**

#### **GET**`/api/calendar/events`

Query params: `start`, `end`, `userId`

#### **POST**`/api/calendar/events`

```json
{
  "title": "Event Title",
  "description": "Event Description",
  "color": "#22c55e",
  "startTime": "2024-03-15T10:00:00Z",
  "endTime": "2024-03-15T11:00:00Z",
  "remindAt": "2024-03-15T09:45:00Z"
}
```

### **👥 Users Endpoints**

#### **GET**`/api/users`(Admin only)

#### **PUT**`/api/users/:id/role`(Admin only)

#### **POST**`/api/users/edit-request`

#### **GET**`/api/users/edit-requests`(Admin only)

---

## Development

### **📝 Scripts**

```shellscript
# Development
npm run dev          # Start frontend dev server
npm run dev:backend  # Start backend dev server
npm run dev:full     # Start both frontend and backend

# Build
npm run build        # Build for production
npm run start        # Start production server

# Database
npm run db:migrate   # Run database migrations
npm run db:seed      # Seed database with sample data
npm run db:studio    # Open Prisma Studio

# Testing
npm run test         # Run tests
npm run test:watch   # Run tests in watch mode
npm run test:coverage # Run tests with coverage

# Linting
npm run lint         # Run ESLint
npm run lint:fix     # Fix ESLint errors
npm run type-check   # TypeScript type checking
```

### **🐳 Docker Setup**

**Dockerfile**:

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

EXPOSE 3000

CMD ["npm", "start"]
```

**docker-compose.yml**:

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/vsm_lectures
    depends_on:
      - db

  db:
    image: postgres:15
    environment:
      POSTGRES_DB: vsm_lectures
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

volumes:
  postgres_data:
```

### **🚀 Deployment**

#### **Vercel (Frontend)**

```shellscript
npm install -g vercel
vercel --prod
```

#### **Railway (Backend)**

```shellscript
npm install -g @railway/cli
railway login
railway init
railway up
```

---

## Đóng góp

Chúng tôi rất hoan nghênh mọi đóng góp! 🎉

### **📋 Quy trình đóng góp**

1. **Fork** repository này
2. **Clone** fork về máy local
3. **Tạo branch** mới: `git checkout -b feature/amazing-feature`
4. **Commit** thay đổi: `git commit -m 'Add amazing feature'`
5. **Push** lên branch: `git push origin feature/amazing-feature`
6. **Tạo Pull Request**


### **📝 Coding Standards**

- ✅ Sử dụng **TypeScript** cho type safety
- ✅ Follow **ESLint** và **Prettier** rules
- ✅ Viết **tests** cho features mới
- ✅ **Comment** code khi cần thiết
- ✅ Sử dụng **conventional commits**


### **🐛 Báo cáo Bug**

Khi báo cáo bug, vui lòng bao gồm:

- 📝 Mô tả chi tiết vấn đề
- 🔄 Các bước tái hiện
- 💻 Environment (OS, browser, version)
- 📸 Screenshots nếu có


### **💡 Đề xuất tính năng**

- 🎯 Mô tả rõ ràng tính năng
- 🤔 Giải thích lý do cần thiết
- 💭 Đưa ra ý tưởng implementation
- 🎨 Mockups/wireframes nếu có


---

## License

Dự án này được phân phối dưới **MIT License**. Xem file [LICENSE](LICENSE) để biết thêm chi tiết.

```plaintext
MIT License

Copyright (c) 2024 Vietnam Student Marathon

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

<div>### ‍️ **Made with ❤️ by Vietnam Student Marathon Community**

**[🌐 Website](https://vsm.org.vn)** • **[📧 Email](mailto:contact@vsm.org.vn)** • **[📱 Facebook](https://facebook.com/vsm.org.vn)**

⭐ **Nếu project này hữu ích, hãy cho chúng tôi một star!** ⭐

</div>```plaintext

Đây là một README siêu đầy đủ và đẹp mắt với:

🎯 **Highlights:**
- ✨ Design đẹp mắt với emojis và badges
- 📚 Hướng dẫn chi tiết từ A-Z
- 🏗️ Kiến trúc backend hoàn chỉnh
- 📡 API documentation đầy đủ
- 🐳 Docker và deployment guides
- 🤝 Contributing guidelines
- 📄 License information

🚀 **Backend Architecture bao gồm:**
- Database schema với Prisma
- Authentication với JWT
- File upload với AWS S3
- Email service
- Rate limiting
- Error handling
- Security best practices
```
